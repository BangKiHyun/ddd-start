# 애그리거트

애그리거트는 관련된 객체를 하나의 군으로 묶어준다. 그렇기에 좀 더 상위 수준에서 도메인 모델 간의 관계를 파악할 수 있다.

## 특징

### 일관성을 관리하는 기준이 된다.

- 애그리거트 단위로 일관성을 관리하기 때문에 복잡한 도메인을 단순한 구조로 만들어준다.
- 복잡도가 낮아지는 만큼 도메인 기능을 확장하고 변경하는 데 필요한 노력도 줄어준다.

</br >

### 한 애그리거트에 속한 객체는 유사하거나 동일한 라이프사이클을 갖는다.

- 예로, 주문 애그리거트를 만들려면 Order, OrderLine, Orderer와 같은 관련 객체를 함께 생성해야 한다.

</br >

### 애그리거트는 독립된 객체 군이며, 각 애그리거트는 자기 자신을 관리할 뿐 다른 애거리거트를 관리하지 않는다.

- 예로, 주문 애그리거트는 배송지를 변경하거나 주문 상품 개수를 변경하는 등 자기 자신을 관리한다.
  - 회원의 비밀번호를 변경하거나 상품의 가격을 변경하지 않는다.

</br >

### 변경되는 빈도가 높은 객체는 한 애그리거트 속할 가능성이 높다.

- OrderLIne의 주문 상품 개수를 변경하면 Order의 총 주문 금액을 새로 계산해야 한다.

</br >

## 주의점

### A가 B를 갖는다 로 해석할 수 있는 요구사항이 있더라도 반드시 A와 B가 한 애그리거트에 속하는 건 아니다

상품과 리뷰가 있다고 생각해보자.

상품 상세 정보와 함께 리뷰 내용을 보여줘야 한다는 요구사항이 있다면 Product와 Review 엔티티가 한 애그리거트에 속한다 생각할 수 있다. 하지만 **Product와 Review는 함께 생성되지 않고 함께 변경되지도 않는다.**

Product를 **변경하는 주체**가 상품 담당자라면 Review를 생성하는 주체는 고객이다.

Review의 변경이 Product에게 영향을 주지 않고 반대도 영향을 주지 않는다.

대부분의 애그리거트는 한 개의 엔티티 객체만 갖는 경우가 많으며, 두 개 이상의 엔티티로 구성되는 애그리거트는 드물게 존재한다고 한다.



